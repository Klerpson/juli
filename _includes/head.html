<!DOCTYPE html>
<html lang="es" dir="ltr" itemscope itemtype="https://schema.org/WebPage">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  
  {% assign page_title = page.title | default: site.title %}
  {% assign page_description = page.description | default: site.description | truncate: 160 %}
  
  <title>{{ page_title }}{% if page.title %} | {{ site.title }}{% endif %}</title>
  <meta name="description" content="{{ page_description }}">
  
  <!-- Indexación Inteligente -->
  <meta name="robots" content="{% if page.noindex or page.url contains 'gracias' or page.url contains 'privada' %}noindex, nofollow{% else %}index, follow, max-snippet:-1, max-image-preview:large{% endif %}">
  
  <!-- Canonical y Alternativas -->
  <link rel="canonical" href="{{ page.url | absolute_url | replace:'index.html','' }}">
  {% if page.url == "/" %}
  <link rel="alternate" href="{{ page.url | absolute_url }}" hreflang="x-default">
  {% endif %}
  
  <!-- Preconexiones Críticas -->
  {% if jekyll.environment == "production" %}
  <link rel="preconnect" href="https://www.googletagmanager.com" crossorigin>
  <link rel="preconnect" href="https://www.google-analytics.com" crossorigin>
  {% endif %}
  
  <!-- Open Graph Dinámico -->
  <meta property="og:type" content="{% if page.layout == 'post' %}article{% else %}website{% endif %}">
  <meta property="og:title" content="{{ page_title }}">
  <meta property="og:description" content="{{ page_description }}">
  <meta property="og:url" content="{{ page.url | absolute_url }}">
  
  {% assign og_image = page.jpg | default: page.hero | default: site.default_image %}
  {% if og_image %}
  <meta property="og:image" content="{{ og_image | absolute_url }}">
  <meta property="og:image:width" content="1200">
  <meta property="og:image:height" content="630">
  {% endif %}
  
  <!-- Recursos Críticos -->
  <link rel="preload" href="{{ 'css/style.css' | relative_url }}" as="style">
  <link rel="stylesheet" href="{{ 'css/style.css' | relative_url }}">
  
  <!-- Precargas de Fuentes -->
  <!-- Playfair Display -->
  <link 
    rel="preload" 
    as="font"
    href="{{ 'css/fonts/playfair-display-v37-latin-regular.woff2' | relative_url }}"
    type="font/woff2"
    crossorigin>
  <link 
    rel="preload" 
    as="font"
    href="{{ 'css/fonts/playfair-display-v37-latin-700.woff2' | relative_url }}"
    type="font/woff2"
    crossorigin>
  <link 
    rel="preload" 
    as="font"
    href="{{ 'css/fonts/playfair-display-v37-latin-900.woff2' | relative_url }}"
    type="font/woff2"
    crossorigin>

  <!-- Lato -->
  <link 
    rel="preload" 
    as="font"
    href="{{ 'css/fonts/lato-v24-latin-regular.woff2' | relative_url }}"
    type="font/woff2"
    crossorigin>
  <link 
    rel="preload" 
    as="font"
    href="{{ 'css/fonts/lato-v24-latin-700.woff2' | relative_url }}"
    type="font/woff2"
    crossorigin>
  <link 
    rel="preload" 
    as="font"
    href="{{ 'css/fonts/lato-v24-latin-900.woff2' | relative_url }}"
    type="font/woff2"
    crossorigin>

  <!-- Estilos de Fuentes -->
  <link rel="preload" href="{{ 'css/fonts/styles.css' | relative_url }}" as="style">
  <link rel="stylesheet" href="{{ 'css/fonts/styles.css' | relative_url }}">
  
  <!-- Favicon -->
  <link rel="icon" href="{{ 'img/favicon/favicon.ico' | relative_url }}">
  <link rel="apple-touch-icon" href="{{ 'img/favicon/apple-touch-icon.png' | relative_url }}">
  
  <!-- Scripts Condicionales -->
  {% if jekyll.environment == "production" %}
    {% if site.gtm_id %}
    <!-- Google Tag Manager -->
    <script>
    (function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':new Date().getTime(),event:'gtm.js'});
    var f=d.getElementsByTagName(s)[0],j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';
    j.async=true;j.src='https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','{{ site.gtm_id }}');
    </script>
    {% endif %}
    
    <!-- Microsoft Clarity (si existe) -->
    {% if site.clarity_id %}
    <script>
    !function(c,l,a){c[a]=c[a]||function(){(c[a].q=c[a].q||[]).push(arguments)};
    var t=l.createElement('script');t.async=1;t.src='https://www.clarity.ms/tag/'+a;
    l.head.appendChild(t);}(window,document,'clarity');
    </script>
    {% endif %}
  {% endif %}

  <!-- Schema.org -->
  <script type="application/ld+json">
    {% include schema.html %}
  </script>
</head>